Search.setIndex({"alltitles":{"API Reference":[[4,null]],"Basic Usage for Flex-Flash-Attention":[[5,"basic-usage-for-flex-flash-attention"]],"Basic Usage for MagiAttention":[[5,"basic-usage-for-magiattention"]],"Calculate Attention":[[4,"calculate-attention"]],"Compute Pad Size":[[4,"compute-pad-size"]],"Contents":[[2,null]],"Dispatch":[[4,"dispatch"]],"Dispatch Function":[[4,"dispatch-function"]],"Environment Variables":[[0,null]],"Flexible Dispatch":[[4,"flexible-dispatch"]],"Flexible Flash Attention":[[4,"flexible-flash-attention"]],"For Debug":[[0,"for-debug"]],"For Performance":[[0,"for-performance"]],"Get Most Recent Key":[[4,"get-most-recent-key"]],"Get Position Ids":[[4,"get-position-ids"]],"Installation":[[3,null]],"MagiAttention documentation":[[2,null]],"QuickStart":[[5,null]],"Step1: Activate an NGC pytorch docker container":[[3,"step1-activate-an-ngc-pytorch-docker-container"]],"Step2: Install required packages":[[3,"step2-install-required-packages"]],"Step3: Install MagiAttention from source":[[3,"step3-install-magiattention-from-source"]],"Undispatch":[[4,"undispatch"]],"Undispatch Function":[[4,"undispatch-function"]],"User Guide":[[1,null],[1,null]],"Utility Functions":[[4,"utility-functions"]],"Varlen Dispatch":[[4,"varlen-dispatch"]]},"docnames":["env_variables","guide","index","install","magi_api","quickstart"],"envversion":{"sphinx":65,"sphinx.domains.c":3,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":9,"sphinx.domains.index":1,"sphinx.domains.javascript":3,"sphinx.domains.math":2,"sphinx.domains.python":4,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2},"filenames":["env_variables.md","guide.md","index.md","install.md","magi_api.md","quickstart.md"],"indexentries":{"calc_attn() (in module magi_attention.api.magi_attn_interface)":[[4,"magi_attention.api.magi_attn_interface.calc_attn",false]],"compute_pad_size() (in module magi_attention.api.functools)":[[4,"magi_attention.api.functools.compute_pad_size",false]],"dispatch() (in module magi_attention.api.magi_attn_interface)":[[4,"magi_attention.api.magi_attn_interface.dispatch",false]],"flex_flash_attn_func() (in module magi_attention.functional.flex_flash_attn)":[[4,"magi_attention.functional.flex_flash_attn.flex_flash_attn_func",false]],"get_most_recent_key() (in module magi_attention.api.magi_attn_interface)":[[4,"magi_attention.api.magi_attn_interface.get_most_recent_key",false]],"get_position_ids() (in module magi_attention.api.magi_attn_interface)":[[4,"magi_attention.api.magi_attn_interface.get_position_ids",false]],"magi_attention.api":[[4,"module-magi_attention.api",false]],"magi_attn_flex_dispatch() (in module magi_attention.api.magi_attn_interface)":[[4,"magi_attention.api.magi_attn_interface.magi_attn_flex_dispatch",false]],"magi_attn_flex_key() (in module magi_attention.api.magi_attn_interface)":[[4,"magi_attention.api.magi_attn_interface.magi_attn_flex_key",false]],"magi_attn_varlen_dispatch() (in module magi_attention.api.magi_attn_interface)":[[4,"magi_attention.api.magi_attn_interface.magi_attn_varlen_dispatch",false]],"magi_attn_varlen_key() (in module magi_attention.api.magi_attn_interface)":[[4,"magi_attention.api.magi_attn_interface.magi_attn_varlen_key",false]],"module":[[4,"module-magi_attention.api",false]],"undispatch() (in module magi_attention.api.magi_attn_interface)":[[4,"magi_attention.api.magi_attn_interface.undispatch",false]]},"objects":{"magi_attention":[[4,0,0,"-","api"]],"magi_attention.api.functools":[[4,1,1,"","compute_pad_size"]],"magi_attention.api.magi_attn_interface":[[4,1,1,"","calc_attn"],[4,1,1,"","dispatch"],[4,1,1,"","get_most_recent_key"],[4,1,1,"","get_position_ids"],[4,1,1,"","magi_attn_flex_dispatch"],[4,1,1,"","magi_attn_flex_key"],[4,1,1,"","magi_attn_varlen_dispatch"],[4,1,1,"","magi_attn_varlen_key"],[4,1,1,"","undispatch"]],"magi_attention.functional.flex_flash_attn":[[4,1,1,"","flex_flash_attn_func"]]},"objnames":{"0":["py","module","Python module"],"1":["py","function","Python function"]},"objtypes":{"0":"py:module","1":"py:function"},"terms":{"":[0,4,5],"0":[4,5],"02":3,"1":[0,2,3,4,5],"10":4,"1024":5,"12288":5,"128":5,"12k":5,"15":4,"16384":5,"16k":5,"1d":4,"1st":5,"2":[0,4,5],"20":4,"2048":[4,5],"20480":5,"20k":5,"24576":5,"24k":5,"25":3,"28672":5,"28k":5,"2d":4,"2k":5,"2nd":5,"3":4,"30":4,"32":5,"32768":5,"32k":5,"4":4,"4096":[4,5],"48":5,"4k":5,"5":4,"512":[4,5],"64":4,"67108864":3,"8":5,"8192":5,"8k":5,"AND":4,"By":4,"For":[1,4],"If":4,"In":[0,4],"The":[0,4],"To":4,"_":[4,5],"about":[4,5],"abov":4,"accept":0,"access":4,"accumul":0,"accuraci":0,"achiev":2,"across":[2,4],"activ":[1,5],"addit":4,"affect":4,"aforement":5,"after":4,"aim":2,"alg":4,"algorithm":0,"align":4,"all":[0,3,4,5],"along":[0,4,5],"alreadi":4,"also":4,"alwai":[0,5],"among":0,"amount":4,"an":[1,4],"ani":4,"api":[1,2,5],"appli":4,"ar":[0,2,4],"arg":5,"argument":[4,5],"assum":5,"atom":4,"attent":[1,2],"attn":[0,4],"attn_mask_typ":[4,5],"attn_type_map":[4,5],"attn_type_map_tensor":5,"attnmasktyp":[4,5],"attnoverlapmod":4,"attnrang":[4,5],"auto_range_merg":4,"automat":4,"avoid":0,"awar":4,"backend":[0,4],"backward":0,"balanc":[4,5],"bash":3,"basic":1,"becaus":4,"befor":0,"below":[0,4],"better":[4,5],"bfloat16":5,"bidirect":4,"bin":3,"block":5,"block_siz":5,"blog":4,"bool":4,"both":4,"bother":[4,5],"bottom":4,"bound":0,"broad":2,"broader":2,"build":3,"cacul":4,"calc_attn":[4,5],"calcul":1,"call":4,"can":[0,4],"care":[4,5],"case":4,"causal":[4,5],"cd":3,"check":0,"chun_siz":4,"chunk":[4,5],"chunk_siz":[4,5],"clear":5,"clearup_dist_env":5,"clone":3,"code":0,"collect":0,"column":4,"com":3,"combin":4,"comm":0,"command":3,"commit":2,"common":5,"commun":[0,2,4],"compelet":5,"complet":4,"comput":5,"compute_pad_s":[4,5],"config":[4,5],"configur":0,"consist":4,"contain":1,"container_mnt_root":3,"container_nam":3,"context":[2,4,5],"continu":2,"control":[4,5],"corr":4,"correct":[0,5],"cost":0,"cp":[0,2,4,5],"cp_group_or_mesh":[4,5],"cp_size":[4,5],"cross":4,"cu_seqlen":4,"cu_seqlen_k":4,"cu_seqlen_q":4,"cu_seqlens_k":4,"cu_seqlens_q":4,"cuda":5,"cumul":4,"custom":5,"d":3,"data":[4,5],"debug":1,"decod":4,"decreas":0,"default":[0,4,5],"defin":[4,5],"degre":4,"descript":[0,4],"design":4,"determinist":[0,4],"develop":4,"devic":[4,5],"devicemesh":4,"differ":4,"dim":[0,4,5],"dimens":5,"directli":4,"disabl":4,"disable_fwd_atomic_reduct":4,"dispatch":[1,5],"dispatch_config":4,"dispatchconfig":4,"dist":4,"dist_attn_config":4,"dist_attn_runtime_kei":4,"distattnconfig":4,"distattnruntimedict":4,"distattnruntimekei":4,"distattnruntimemgr":4,"distribut":[2,4,5],"divers":4,"divid":4,"divis":4,"dkv":0,"do":4,"docker":1,"doe":4,"doesn":4,"don":4,"doubl":0,"downcast":0,"dtype":[0,4,5],"due":4,"dure":4,"e":[0,4,5],"each":[4,5],"easi":4,"effect":0,"either":5,"element":4,"els":4,"emb":5,"embed":5,"embed_dim":5,"empti":4,"enabl":[0,4],"encod":4,"enhanc":2,"ensur":4,"enum":[4,5],"env":0,"environ":[1,2,4,5],"etc":5,"even":4,"evenli":4,"exampl":[4,5],"excit":2,"exec":3,"exist":4,"exp":[4,5],"explain":4,"explan":4,"extern":4,"extra":0,"factor":5,"fals":4,"faster":4,"featur":[0,2],"ffa":[0,5],"final":4,"first":4,"flag":4,"flash":1,"flash_attn_varlen":4,"flashattent":4,"flex":[1,4],"flex_flash_attn":4,"flex_flash_attn_func":[4,5],"flexibl":[1,2],"flexible_flash_attent":4,"float":4,"float32":4,"follow":[4,5],"forward":[0,4],"found":4,"fp32":[0,5],"fp64":0,"from":[0,1,4,5],"from_rang":[4,5],"full":[4,5],"function":[1,5],"functool":4,"further":4,"futur":0,"g":[4,5],"gather":4,"gener":[2,4],"get_most_recent_kei":4,"get_position_id":4,"git":3,"github":[3,4],"global":4,"gpt":4,"gpu":[3,4,5],"gqa":5,"granular":[4,5],"group":[0,4],"guid":2,"ha":4,"have":[4,5],"head":5,"head_dim":[4,5],"helper":5,"here":3,"heterogen":2,"hidden_s":4,"hierarch":0,"high":0,"higher":0,"hold":[4,5],"horizon":2,"host":3,"host_mnt_root":3,"howev":[0,4],"http":[3,4],"i":[0,2,4,5],"imag":3,"implement":4,"import":5,"improv":2,"includ":4,"inconsist":4,"increas":0,"inform":4,"init":3,"initi":5,"inner":[4,5],"inplac":0,"input":[4,5],"insert":4,"insid":0,"inspir":4,"instal":[1,2],"int":4,"int32":[4,5],"inter":0,"inter_nod":0,"interfac":[4,5],"intersect":4,"intra_nod":0,"invers":4,"invok":4,"involv":2,"io":[3,4],"ipc":3,"irregular":4,"is_k_permut":4,"is_q_permut":4,"is_same_sourc":4,"isol":3,"k":[4,5],"k_proj":5,"k_project":4,"k_rang":[4,5],"k_ranges_tensor":5,"kei":5,"kernel":[0,2,4],"known":5,"kv":0,"last":4,"layer":5,"left":4,"len":5,"length":[4,5],"level":2,"like":[0,2,4,5],"limit":4,"linear":[2,5],"list":4,"llama":4,"load":[4,5],"local":[4,5],"local_k":[4,5],"local_ls":5,"local_out":[4,5],"local_q":[4,5],"local_rank":5,"local_v":[4,5],"local_x":[4,5],"log":[4,5],"logic":4,"long":[0,2,4],"look":5,"loss":[4,5],"lse":[0,4,5],"magi":2,"magi_attent":[0,4,5],"magi_attention_deterministic_mod":0,"magi_attention_ffa_backward_high_precision_reduc":0,"magi_attention_ffa_backward_sm_margin":0,"magi_attention_ffa_forward_inplace_correct":0,"magi_attention_ffa_forward_sm_margin":0,"magi_attention_hierarchical_comm":0,"magi_attention_sanity_check":0,"magi_attention_sdpa_backend":0,"magi_attn_flex_dispatch":[4,5],"magi_attn_flex_kei":4,"magi_attn_interfac":4,"magi_attn_kernel":4,"magi_attn_runtime_kei":5,"magi_attn_varlen_dispatch":4,"magi_attn_varlen_kei":4,"magi_runtime_kei":5,"magiattent":[0,1,4],"mai":[4,5],"mainli":4,"make":4,"mani":[0,4,5],"map":4,"margin":0,"mask":[2,4,5],"math":0,"matmul":5,"max":5,"max_num_chunk":4,"max_seqlen_k":[4,5],"max_seqlen_q":[4,5],"maximum":4,"meanwhil":4,"mechan":2,"memlock":3,"memori":0,"mention":4,"merg":4,"mesh":4,"meta":[4,5],"might":[0,4,5],"min_chunk_s":4,"minheapdispatchalg":4,"mix":4,"modal":4,"mode":[0,4],"moment":5,"more":[4,5],"multi":4,"multipl":[4,5],"multiprocessor":4,"name":[3,4],"nccl":4,"need":[0,4,5],"neglig":0,"network":3,"new":2,"new_group":4,"ngc":1,"nn":5,"node":0,"non":[0,4],"none":5,"norm":5,"note":[3,4,5],"now":[0,4,5],"num_head":4,"num_heads_kv":5,"num_heads_q":5,"num_rang":4,"num_tokens_k":4,"num_tokens_kv":4,"num_tokens_q":4,"num_tokens_v":4,"number":[0,4,5],"numer":4,"nvcr":3,"nvidia":3,"object":4,"obtain":4,"one":[4,5],"onli":[0,4,5],"onlin":5,"op":4,"oper":5,"option":4,"order":5,"org":[3,4],"origin":4,"other":[4,5],"our":4,"out":[0,4,5],"output":[4,5],"overhead":0,"overlap":4,"overlap_config":4,"overlapalgtyp":4,"overlapconfig":4,"overview":2,"packag":1,"pad":5,"pad_siz":[4,5],"parallel":[2,4,5],"paramet":4,"part":4,"partial":[0,5],"particularli":2,"pass":4,"perform":[1,2,4,5],"permut":4,"pip":3,"point":4,"post":0,"postion":4,"precis":0,"privileg":3,"process":[0,4],"processgroup":4,"project":[4,5],"provid":4,"py3":3,"pytorch":1,"q":[4,5],"q_proj":5,"q_project":4,"q_rang":[4,5],"q_ranges_tensor":5,"qkv":5,"queri":[4,5],"quickli":4,"quickstart":[1,2],"r":[3,4],"rais":4,"randn":[4,5],"rang":[2,4],"rank":[0,4,5],"re":4,"receiv":4,"recommend":4,"recov":4,"recurs":3,"reduc":0,"reduct":[4,5],"redund":0,"ref":4,"refer":[1,2],"releas":3,"remov":0,"repres":4,"requir":[1,4],"requires_grad":[4,5],"research":2,"reserv":4,"respect":2,"result":[0,4],"result_correct":0,"return":[4,5],"right":[4,5],"rope":[4,5],"row":4,"run":[3,5],"safe":5,"same":4,"sampl":5,"sandai":[3,4],"saniti":0,"save":0,"scalabl":2,"scale":4,"scenario":2,"script":5,"sdpa":0,"second":5,"see":4,"seed":5,"self":4,"semant":4,"seq_dim":4,"seq_len":4,"seqlen":[4,5],"seqlen_k":4,"seqlen_q":4,"seqln":4,"sequenc":4,"set":[0,4,5],"setup_dist_env":5,"shape":4,"share":4,"should":[4,5],"shuffl":5,"similar":4,"simul":5,"sinc":[0,4],"size":[2,5],"slice":5,"slide":4,"sm":[0,4],"sm_margin":4,"so":5,"softcap":4,"softmax":[4,5],"softmax_scal":[4,5],"solut":0,"some":[0,4,5],"sourc":[1,4],"spars":4,"specifi":4,"sqrt":[4,5],"stabil":4,"stabl":0,"stack":3,"stai":2,"start":4,"static":4,"step1":1,"step2":1,"step3":1,"still":4,"storag":0,"str":4,"strategi":2,"stream":4,"strongli":4,"submodul":3,"subsequ":4,"suitabl":2,"sum":[4,5],"support":[0,2,4],"suppos":0,"switch":0,"t":4,"t5":4,"task":2,"temporari":0,"tensor":[4,5],"tenspr":4,"test":0,"thei":4,"them":4,"therefor":4,"thi":[0,4],"through":[0,4],"toggl":0,"token":[4,5],"top":4,"torch":[4,5],"torchrun":5,"total":4,"total_k":4,"total_out":[4,5],"total_q":4,"total_seqlen":[4,5],"total_seqlen_k":[4,5],"total_seqlen_q":[4,5],"total_v":4,"train":2,"transform":4,"troubl":4,"true":[4,5],"tune":2,"tupl":4,"two":4,"txt":3,"type":[2,4],"ulimit":3,"ultra":2,"under":4,"undispatch":[1,5],"unexpect":4,"uniform":4,"unmask":5,"unpad":[4,5],"unpermut":4,"until":5,"up":5,"updat":[0,3],"us":[0,4,5],"usag":1,"user":[2,4,5],"usual":4,"util":[1,5],"v":[3,4,5],"v_proj":5,"v_project":4,"valu":[4,5],"valueerror":4,"variabl":[1,2],"varieti":2,"ve":4,"version":3,"video":2,"view":5,"visual":4,"w":4,"wai":4,"we":[0,2,4,5],"when":4,"where":5,"whether":4,"which":[2,4,5],"while":[2,4,5],"wide":2,"window":4,"wise":[4,5],"within":0,"world_group":5,"world_siz":5,"x":[4,5],"you":[4,5]},"titles":["Environment Variables","User Guide","MagiAttention documentation","Installation","API Reference","QuickStart"],"titleterms":{"For":0,"activ":3,"an":3,"api":4,"attent":[4,5],"basic":5,"calcul":4,"comput":4,"contain":3,"content":2,"debug":0,"dispatch":4,"docker":3,"document":2,"environ":0,"flash":[4,5],"flex":5,"flexibl":4,"from":3,"function":4,"get":4,"guid":1,"id":4,"instal":3,"kei":4,"magiattent":[2,3,5],"most":4,"ngc":3,"packag":3,"pad":4,"perform":0,"posit":4,"pytorch":3,"quickstart":5,"recent":4,"refer":4,"requir":3,"size":4,"sourc":3,"step1":3,"step2":3,"step3":3,"undispatch":4,"usag":5,"user":1,"util":4,"variabl":0,"varlen":4}})